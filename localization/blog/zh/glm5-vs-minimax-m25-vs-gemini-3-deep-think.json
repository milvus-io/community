{"codeList":["pip install --upgrade pymilvus openai requests tqdm \n","import os\nos.environ[\"OPENROUTER_API_KEY\"] = \"**********\" \n","wget https://github.com/milvus-io/milvus-docs/releases/download/v2.4.6-preview/milvus_docs_2.4.x_en.zip\nunzip -q milvus_docs_2.4.x_en.zip -d milvus_docs\n","from glob import glob\ntext_lines = []\nfor file_path in glob(\"milvus_docs/en/faq/*.md\", recursive=True):\n    with open(file_path, \"r\") as file:\n        file_text = file.read()\n    text_lines += file_text.split(\"# \")\n","from openai import OpenAI\nglm_client = OpenAI(\n    api_key=os.environ[\"OPENROUTER_API_KEY\"],\n    base_url=\"https://openrouter.ai/api/v1\",\n)\n","EMBEDDING_MODEL = \"openai/text-embedding-3-small\"  # OpenRouter embedding model\nresp = glm_client.embeddings.create(\n    model=EMBEDDING_MODEL,\n    input=[\"This is a test1\", \"This is a test2\"],\n)\ntest_embeddings = [d.embedding for d in resp.data]\nembedding_dim = len(test_embeddings[0])\nprint(embedding_dim)\nprint(test_embeddings[0][:10])\n","1536\n[0.010637564584612846, -0.017222722992300987, 0.05409347265958786, -0.04377825930714607, -0.017545074224472046, -0.04196695610880852, -0.0011963422875851393, 0.03837504982948303, 0.0008855042979121208, 0.015181170776486397]\n","from pymilvus import MilvusClient\nmilvus_client = MilvusClient(uri=\"./milvus_demo.db\")\ncollection_name = \"my_rag_collection\"\n","if milvus_client.has_collection(collection_name):\n    milvus_client.drop_collection(collection_name)\n","milvus_client.create_collection(\n    collection_name=collection_name,\n    dimension=embedding_dim,\n    metric_type=\"COSINE\",\n    consistency_level=\"Strong\",\n)\n","from tqdm import tqdm\ndata = []\nresp = glm_client.embeddings.create(model=EMBEDDING_MODEL, input=text_lines)\ndoc_embeddings = [d.embedding for d in resp.data]\nfor i, line in enumerate(tqdm(text_lines, desc=\"Creating embeddings\")):\n    data.append({\"id\": i, \"vector\": doc_embeddings[i], \"text\": line})\nmilvus_client.insert(collection_name=collection_name, data=data)\n","Creating embeddings: 100%|██████████████████████████| 72/72 [00:00<00:00, 125203.10it/s]\n{'insert_count': 72, 'ids': [0, 1, 2, ..., 71], 'cost': 0}\n","question = \"How is data stored in milvus?\"\n","resp = glm_client.embeddings.create(model=EMBEDDING_MODEL, input=[question])\nquestion_embedding = resp.data[0].embedding\nsearch_res = milvus_client.search(\n    collection_name=collection_name,\n    data=[question_embedding],\n    limit=3,\n    search_params={\"metric_type\": \"COSINE\", \"params\": {}},\n    output_fields=[\"text\"],\n)\n","import json\n\nretrieved_lines_with_distances = [\n    (res[\"entity\"][\"text\"], res[\"distance\"]) for res in search_res[0]\n]\nprint(json.dumps(retrieved_lines_with_distances, indent=4))\n\n[\n    [\n        \" Where does Milvus store data?\\n\\nMilvus deals with two types of data, inserted data and metadata. \\n\\nInserted data, including vector data, scalar data, and collection-specific schema, are stored in persistent storage as incremental log. Milvus supports multiple object storage backends, including MinIO, AWS S3, Google Cloud Storage (GCS), Azure Blob Storage, Alibaba Cloud OSS, and Tencent Cloud Object Storage (COS).\\n\\nMetadata are generated within Milvus. Each Milvus module has its own metadata that are stored in etcd.\\n\\n###\",\n        0.7826977372169495\n    ],\n    [\n        \"How does Milvus handle vector data types and precision?\\n\\nMilvus supports Binary, Float32, Float16, and BFloat16 vector types.\\n\\n- Binary vectors: Store binary data as sequences of 0s and 1s, used in image processing and information retrieval.\\n- Float32 vectors: Default storage with a precision of about 7 decimal digits. Even Float64 values are stored with Float32 precision, leading to potential precision loss upon retrieval.\\n- Float16 and BFloat16 vectors: Offer reduced precision and memory usage. Float16 is suitable for applications with limited bandwidth and storage, while BFloat16 balances range and efficiency, commonly used in deep learning to reduce computational requirements without significantly impacting accuracy.\\n\\n###\",\n        0.6772387027740479\n    ],\n    [\n        \"How much does Milvus cost?\\n\\nMilvus is a 100% free open-source project.\\n\\nPlease adhere to Apache License 2.0 when using Milvus for production or distribution purposes.\\n\\nZilliz, the company behind Milvus, also offers a fully managed cloud version of the platform for those that don't want to build and maintain their own distributed instance. Zilliz Cloud automatically maintains data reliability and allows users to pay only for what they use.\\n\\n###\",\n        0.6467022895812988\n    ]\n]\n","context = \"\\n\".join(\n    [line_with_distance[0] for line_with_distance in retrieved_lines_with_distances]\n)\n","SYSTEM_PROMPT = \"\"\"\nHuman: You are an AI assistant. You can find answers to the questions in the contextual passage snippets provided.\n\"\"\"\nUSER_PROMPT = f\"\"\"\nUse the following pieces of information enclosed in <context> tags to provide an answer to the question enclosed in <question> tags.\n<context>\n{context}\n</context>\n<question>\n{question}\n</question>\n\"\"\"\n","response = glm_client.chat.completions.create(\n    model=\"z-ai/glm-5\",\n    messages=[\n        {\"role\": \"system\", \"content\": SYSTEM_PROMPT},\n        {\"role\": \"user\", \"content\": USER_PROMPT},\n    ],\n)\nprint(response.choices[0].message.content)\n","Based on the provided context, Milvus stores data in two main ways, depending on the data type:\n\n1. Inserted Data\n   - What it includes: vector data, scalar data, and collection-specific schema.\n   - How it is stored: in persistent storage as an incremental log.\n   - Storage Backends: Milvus supports multiple object storage backends, including MinIO, AWS S3, Google Cloud Storage (GCS), Azure Blob Storage, Alibaba Cloud OSS, and Tencent Cloud Object Storage (COS).\n   - Vector Specifics: vector data can be stored as Binary vectors (sequences of 0s and 1s), Float32 vectors (default storage), or Float16 and BFloat16 vectors (offering reduced precision and memory usage).\n\n2. Metadata\n   - What it includes: data generated within Milvus modules.\n   - How it is stored: in etcd.\n"],"headingContent":"","anchorList":[{"label":"GLM-5、MiniMax M2.5 和双子座 3 深度思考一览","href":"GLM-5-MiniMax-M25-and-Gemini-3-Deep-Think-at-a-Glance","type":2,"isActive":false},{"label":"上机比较","href":"Hands-On-Comparisons","type":2,"isActive":false},{"label":"如何在 GLM-5、MiniMax M2.5 和 Gemin 3 Deep Think 之间做出选择","href":"How-to-Choose-Between-GLM-5-MiniMax-M25-and-Gemin-3-Deep-Think","type":2,"isActive":false},{"label":"RAG 教程：用 Milvus 为 GLM-5 连接知识库","href":"RAG-Tutorial-Wire-Up-GLM-5-with-Milvus-for-a-Knowledge-Base","type":2,"isActive":false},{"label":"结论：选择模型，然后构建管道","href":"Conclusion-Pick-the-Model-Then-Build-the-Pipeline","type":2,"isActive":false}]}