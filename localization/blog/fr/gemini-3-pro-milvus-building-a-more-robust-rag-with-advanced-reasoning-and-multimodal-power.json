{"codeList":["! pip install --upgrade pymilvus google-generativeai requests tqdm\n","import os\nos.environ[\"GEMINI_API_KEY\"] = \"**********\"\n","! wget https://github.com/milvus-io/milvus-docs/releases/download/v2.4.6-preview/milvus_docs_2.4.x_en.zip\n! unzip -q milvus_docs_2.4.x_en.zip -d milvus_docs\n","from glob import glob\ntext_lines = []\nfor file_path in glob(\"milvus_docs/en/faq/*.md\", recursive=True):\n    with open(file_path, \"r\") as file:\n        file_text = file.read()\n    text_lines += file_text.split(\"# \")\n","import google.generativeai as genai\ngenai.configure(api_key=os.environ[\"GEMINI_API_KEY\"])\ngemini_model = genai.GenerativeModel(\"gemini-3-pro-preview\")\nresponse = gemini_model.generate_content(\"who are you\")\nprint(response.text)\n","test_embeddings = genai.embed_content(\n    model=\"models/text-embedding-004\", content=[\"This is a test1\", \"This is a test2\"]\n)[\"embedding\"]\nembedding_dim = len(test_embeddings[0])\nprint(embedding_dim)\nprint(test_embeddings[0][:10])\n","from pymilvus import MilvusClient\nmilvus_client = MilvusClient(uri=\"./milvus_demo.db\")\ncollection_name = \"my_rag_collection\"\n","if milvus_client.has_collection(collection_name):\n    milvus_client.drop_collection(collection_name)\n","milvus_client.create_collection(\n    collection_name=collection_name,\n    dimension=embedding_dim,\n    metric_type=\"COSINE\",\n    consistency_level=\"Strong\",  # Strong consistency level\n)\n","from tqdm import tqdm\ndata = []\ndoc_embeddings = genai.embed_content(\n    model=\"models/text-embedding-004\", content=text_lines\n)[\"embedding\"]\nfor i, line in enumerate(tqdm(text_lines, desc=\"Creating embeddings\")):\n    data.append({\"id\": i, \"vector\": doc_embeddings[i], \"text\": line})\nmilvus_client.insert(collection_name=collection_name, data=data)\n","Creating embeddings: 100%|█████████████████████████| 72/72 [00:00<00:00, 431414.13it/s]\n{'insert_count': 72, 'ids': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71], 'cost': 0}\n","question = \"How is data stored in milvus?\"\n","question_embedding = genai.embed_content(\n    model=\"models/text-embedding-004\", content=question\n)[\"embedding\"]\nsearch_res = milvus_client.search(\n    collection_name=collection_name,\n    data=[question_embedding],\n    limit=3,  # Return top 3 results\n    search_params={\"metric_type\": \"COSINE\", \"params\": {}},  # Inner product distance\n    output_fields=[\"text\"],  # Return the text field\n)\nimport json\nretrieved_lines_with_distances = [\n    (res[\"entity\"][\"text\"], res[\"distance\"]) for res in search_res[0]\n]\nprint(json.dumps(retrieved_lines_with_distances, indent=4))\n","[\n    [\n        \" Where does Milvus store data?\\n\\nMilvus deals with two types of data, inserted data and metadata. \\n\\nInserted data, including vector data, scalar data, and collection-specific schema, are stored in persistent storage as incremental log. Milvus supports multiple object storage backends, including [MinIO](\nhttps://min.io/\n), [AWS S3](\nhttps://aws.amazon.com/s3/?nc1=h_ls\n), [Google Cloud Storage](\nhttps://cloud.google.com/storage?hl=en#object-storage-for-companies-of-all-sizes\n) (GCS), [Azure Blob Storage](\nhttps://azure.microsoft.com/en-us/products/storage/blobs\n), [Alibaba Cloud OSS](\nhttps://www.alibabacloud.com/product/object-storage-service\n), and [Tencent Cloud Object Storage](\nhttps://www.tencentcloud.com/products/cos\n) (COS).\\n\\nMetadata are generated within Milvus. Each Milvus module has its own metadata that are stored in etcd.\\n\\n###\",\n        0.8048489093780518\n    ],\n    [\n        \"Does the query perform in memory? What are incremental data and historical data?\\n\\nYes. When a query request comes, Milvus searches both incremental data and historical data by loading them into memory. Incremental data are in the growing segments, which are buffered in memory before they reach the threshold to be persisted in storage engine, while historical data are from the sealed segments that are stored in the object storage. Incremental data and historical data together constitute the whole dataset to search.\\n\\n###\",\n        0.757495105266571\n    ],\n    [\n        \"What is the maximum dataset size Milvus can handle?\\n\\n  \\nTheoretically, the maximum dataset size Milvus can handle is determined by the hardware it is run on, specifically system memory and storage:\\n\\n- Milvus loads all specified collections and partitions into memory before running queries. Therefore, memory size determines the maximum amount of data Milvus can query.\\n- When new entities and and collection-related schema (currently only MinIO is supported for data persistence) are added to Milvus, system storage determines the maximum allowable size of inserted data.\\n\\n###\",\n        0.7453694343566895\n    ]\n]\n","context = \"\\n\".join(\n    [line_with_distance[0] for line_with_distance in retrieved_lines_with_distances]\n)\n","SYSTEM_PROMPT = \"\"\"\nHuman: You are an AI assistant. You are able to find answers to the questions from the contextual passage snippets provided.\n\"\"\"\nUSER_PROMPT = f\"\"\"\nUse the following pieces of information enclosed in <context> tags to provide an answer to the question enclosed in <question> tags.\n<context>\n{context}\n</context>\n<question>\n{question}\n</question>\n\"\"\"\n","gemini_model = genai.GenerativeModel(\n    \"gemini-3-pro-preview\", system_instruction=SYSTEM_PROMPT\n)\nresponse = gemini_model.generate_content(USER_PROMPT)\nprint(response.text)\n","Based on the provided documents, Milvus stores data in the following ways:\n*   **Inserted Data:** Vector data, scalar data, and collection-specific schema are stored in persistent storage as an incremental log. Milvus supports multiple object storage backends for this purpose, including:\n    *   MinIO\n    *   AWS S3\n    *   Google Cloud Storage (GCS)\n    *   Azure Blob Storage\n    *   Alibaba Cloud OSS\n    *   Tencent Cloud Object Storage (COS)\n*   **Metadata:** Metadata generated within Milvus modules is stored in **etcd**.\n*   **Memory Buffering:** Incremental data (growing segments) are buffered in memory before being persisted, while historical data (sealed segments) resides in object storage but is loaded into memory for querying.\n","from openai import OpenAI\nclient = OpenAI(\n  base_url=\"https://openrouter.ai/api/v1\",\n  api_key=\"<OPENROUTER_API_KEY>\",\n)\nresponse2 = client.chat.completions.create(\n  model=\"google/gemini-3-pro-preview\",\n  messages=[\n        {\n            \"role\": \"system\",\n            \"content\": SYSTEM_PROMPT\n        },\n        {\n            \"role\": \"user\", \n            \"content\": USER_PROMPT\n        }\n    ],\n  extra_body={\"reasoning\": {\"enabled\": True}}\n)\nresponse_message = response2.choices[0].message\nprint(response_message.content)\n"],"headingContent":"","anchorList":[{"label":"Principales mises à jour de Gemini 3 Pro","href":"Major-Upgrades-in-Gemini-3-Pro","type":2,"isActive":false},{"label":"Mise à l'épreuve de Gemini 3 Pro","href":"Putting-Gemini-3-Pro-to-the-Test","type":2,"isActive":false},{"label":"Comment construire un système RAG avec Gemini 3 Pro et Milvus","href":"How-to-Build-a-RAG-System-with-Gemini-3-Pro-and-Milvus","type":2,"isActive":false},{"label":"Encore une chose : Vibe Coding avec Google Antigravity","href":"One-More-Thing-Vibe-Coding-with-Google-Antigravity","type":2,"isActive":false},{"label":"Prêt à construire ?","href":"Ready-to-Build","type":2,"isActive":false}]}