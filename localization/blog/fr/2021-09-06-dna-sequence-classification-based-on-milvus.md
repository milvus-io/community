---
id: dna-sequence-classification-based-on-milvus.md
title: Classification des séquences d'ADN sur la base de Milvus
author: Jael Gu
date: 2021-09-06T06:02:27.431Z
desc: >-
  Utilisez Milvus, une base de données vectorielle libre, pour reconnaître les
  familles de gènes des séquences d'ADN. Moins d'espace mais plus de précision.
cover: assets.zilliz.com/11111_5d089adf08.png
tag: Scenarios
canonicalUrl: 'https://zilliz.com/blog/dna-sequence-classification-based-on-milvus'
---
<custom-h1>Classification des séquences d'ADN basée sur Milvus</custom-h1><blockquote>
<p>Auteur : Mengjia Gu, ingénieur en données chez Zilliz, est titulaire d'un master en sciences de l'information de l'université McGill. Elle s'intéresse aux applications de l'intelligence artificielle et à la recherche de similarités dans les bases de données vectorielles. En tant que membre de la communauté du projet open-source Milvus, elle a fourni et amélioré diverses solutions, comme le système de recommandation et le modèle de classification des séquences d'ADN. Elle aime les défis et n'abandonne jamais !</p>
</blockquote>
<custom-h1>Introduction</custom-h1><p>La séquence d'ADN est un concept populaire tant dans la recherche universitaire que dans les applications pratiques, telles que la traçabilité des gènes, l'identification des espèces et le diagnostic des maladies. Alors que toutes les industries sont à la recherche d'une méthode de recherche plus intelligente et plus efficace, l'intelligence artificielle a attiré beaucoup d'attention, en particulier dans les domaines biologique et médical. De plus en plus de scientifiques et de chercheurs contribuent à l'apprentissage automatique et à l'apprentissage profond en bio-informatique. Pour rendre les résultats expérimentaux plus convaincants, une option courante consiste à augmenter la taille de l'échantillon. La collaboration avec le big data en génomique apporte également plus de possibilités de cas d'utilisation dans la réalité. Cependant, l'alignement traditionnel des séquences présente des limites qui le rendent <a href="https://www.frontiersin.org/articles/10.3389/fbioe.2020.01032/full#h5">inadapté aux données volumineuses</a>. Afin de faire moins de compromis dans la réalité, la vectorisation est un bon choix pour un grand ensemble de données de séquences d'ADN.</p>
<p>La base de données vectorielles open source <a href="https://milvus.io/docs/v2.0.x/overview.md">Milvus</a> est adaptée aux données massives. Elle est capable de stocker des vecteurs de séquences d'acides nucléiques et d'effectuer des recherches très efficaces. Elle peut également contribuer à réduire les coûts de production ou de recherche. Le système de classification des séquences d'ADN basé sur Milvus ne prend que quelques millisecondes pour classer les gènes. En outre, il présente une précision supérieure à celle d'autres classificateurs courants dans le domaine de l'apprentissage automatique.</p>
<custom-h1>Traitement des données</custom-h1><p>Un gène qui code l'information génétique est constitué d'une petite section de séquences d'ADN, qui se compose de 4 bases nucléotidiques [A, C, G, T]. Le génome humain compte environ 30 000 gènes, soit près de 3 milliards de paires de bases d'ADN, et chaque paire de bases a deux bases correspondantes. Pour permettre diverses utilisations, les séquences d'ADN peuvent être classées en plusieurs catégories. Afin de réduire le coût et de faciliter l'utilisation des données des longues séquences d'ADN, le <a href="https://en.wikipedia.org/wiki/K-mer#:~:text=Usually%2C%20the%20term%20k%2Dmer,total%20possible%20k%2Dmers%2C%20where">k-mer </a>est introduit dans le prétraitement des données. En même temps, il rend les données de séquences d'ADN plus semblables à du texte brut. En outre, les données vectorisées peuvent accélérer les calculs dans l'analyse des données ou l'apprentissage automatique.</p>
<p>
  
   <span class="img-wrapper"> <img translate="no" src="https://assets.zilliz.com/1_a7469e9eac.png" alt="1.png" class="doc-image" id="1.png" />
   </span> <span class="img-wrapper"> <span>1.png</span> </span></p>
<p><strong>k-mer</strong></p>
<p>La méthode k-mer est couramment utilisée dans le prétraitement des séquences d'ADN. Elle extrait une petite section de longueur k à partir de chaque base de la séquence originale, convertissant ainsi une longue séquence de longueur s en (s-k+1) courtes séquences de longueur k. L'ajustement de la valeur de k permet d'améliorer les performances du modèle. Les listes de séquences courtes sont plus faciles à lire, à extraire et à vectoriser.</p>
<p><strong>Vectorisation</strong></p>
<p>Les séquences d'ADN sont vectorisées sous forme de texte. Une séquence transformée par k-mer devient une liste de séquences courtes, qui ressemble à une liste de mots individuels dans une phrase. Par conséquent, la plupart des modèles de traitement du langage naturel devraient également fonctionner pour les données relatives aux séquences d'ADN. Des méthodologies similaires peuvent être appliquées à la formation des modèles, à l'extraction des caractéristiques et à l'encodage. Chaque modèle ayant ses propres avantages et inconvénients, la sélection des modèles dépend des caractéristiques des données et de l'objectif de la recherche. Par exemple, CountVectorizer, un modèle de sac de mots, met en œuvre l'extraction de caractéristiques par le biais d'une simple tokenisation. Il ne fixe aucune limite à la longueur des données, mais le résultat obtenu est moins évident en termes de comparaison de similarité.</p>
<custom-h1>Démonstration de Milvus</custom-h1><p>Milvus peut facilement gérer des données non structurées et rappeler les résultats les plus similaires parmi des trillions de vecteurs dans un délai moyen de quelques millisecondes. Sa recherche de similarité est basée sur l'algorithme de recherche ANN (Approximate Nearest Neighbor). Ces caractéristiques font de Milvus une excellente option pour gérer les vecteurs de séquences d'ADN et promouvoir ainsi le développement et les applications de la bio-informatique.</p>
<p>Voici une démonstration montrant comment construire un système de classification de séquences d'ADN avec Milvus. L'<a href="https://www.kaggle.com/nageshsingh/dna-sequence-dataset">ensemble de données expérimentales </a>comprend 3 organismes et 7 familles de gènes. Toutes les données sont converties en listes de séquences courtes par k-mers. Avec un modèle CountVectorizer pré-entraîné, le système encode ensuite les données de séquences en vecteurs. L'organigramme ci-dessous décrit la structure du système et les processus d'insertion et de recherche.</p>
<p>
  
   <span class="img-wrapper"> <img translate="no" src="https://assets.zilliz.com/1_ebd89660f6.png" alt="1.png" class="doc-image" id="1.png" />
   </span> <span class="img-wrapper"> <span>1.png</span> </span></p>
<p>Essayez cette démo au <a href="https://github.com/milvus-io/bootcamp/tree/master/solutions/dna_sequence_classification">camp d'entraînement Milvus</a>.</p>
<p>Dans Milvus, le système crée une collection et insère les vecteurs correspondants de séquences d'ADN dans la collection (ou la partition si elle est activée). Lorsqu'il reçoit une requête, Milvus renvoie les distances entre le vecteur de la séquence d'ADN d'entrée et les résultats les plus similaires dans la base de données. La classe de la séquence d'entrée et la similarité entre les séquences d'ADN peuvent être déterminées par les distances entre les vecteurs dans les résultats.</p>
<pre><code translate="no"><span class="hljs-comment"># Insert vectors to Milvus collection (partition &quot;human&quot;)</span>
DNA_human = collection.insert([human_ids, human_vectors], partition_name=<span class="hljs-string">&#x27;human&#x27;</span>)
<span class="hljs-comment"># Search topK results (in partition &quot;human&quot;) for test vectors</span>
res = collection.search(test_vectors, <span class="hljs-string">&quot;vector_field&quot;</span>, search_params, limit=topK, partition_names=[<span class="hljs-string">&#x27;human&#x27;</span>])
<span class="hljs-keyword">for</span> results <span class="hljs-keyword">in</span> res:
    res_ids = results.ids <span class="hljs-comment"># primary keys of topK results</span>
    res_distances = results.distances <span class="hljs-comment"># distances between topK results &amp; search input</span>
<button class="copy-code-btn"></button></code></pre>
<p><strong>Classification des séquences d'ADN</strong>La recherche des séquences d'ADN les plus similaires dans Milvus pourrait impliquer la famille de gènes d'un échantillon inconnu, ce qui permettrait d'en apprendre davantage sur sa fonctionnalité éventuelle.<a href="https://www.nature.com/scitable/topicpage/gpcr-14047471/"> Si une séquence est classée comme GPCR, elle a probablement une influence sur les fonctions de l'organisme. </a>Dans cette démonstration, Milvus a permis au système d'identifier les familles de gènes des séquences d'ADN humain recherchées.</p>
<p>
  
   <span class="img-wrapper"> <img translate="no" src="https://assets.zilliz.com/3_1616da5bb0.png" alt="3.png" class="doc-image" id="3.png" />
   </span> <span class="img-wrapper"> <span>3.png</span> </span> <span class="img-wrapper"> <img translate="no" src="https://assets.zilliz.com/4_d719b22fc7.png" alt="4.png" class="doc-image" id="4.png" /><span>4.png</span> </span></p>
<p><strong>Similitude génétique</strong></p>
<p>La similarité moyenne des séquences d'ADN entre les organismes illustre la proximité de leurs génomes. La démo recherche dans les données humaines les séquences d'ADN les plus similaires à celles du chimpanzé et du chien respectivement. Elle calcule et compare ensuite les distances moyennes entre les produits intérieurs (0,97 pour le chimpanzé et 0,70 pour le chien), ce qui prouve que le chimpanzé partage plus de gènes similaires avec l'homme que le chien. Avec des données et une conception de système plus complexes, Milvus est en mesure de soutenir la recherche génétique à un niveau encore plus élevé.</p>
<pre><code translate="no">search_params = {<span class="hljs-string">&quot;metric_type&quot;</span>: <span class="hljs-string">&quot;IP&quot;</span>, <span class="hljs-string">&quot;params&quot;</span>: {<span class="hljs-string">&quot;nprobe&quot;</span>: <span class="hljs-number">20</span>}}
<button class="copy-code-btn"></button></code></pre>
<p><strong>Performances</strong></p>
<p>La démo entraîne le modèle de classification avec 80 % des données de l'échantillon humain (3629 au total) et utilise le reste comme données de test. Elle compare les performances du modèle de classification des séquences d'ADN qui utilise Milvus avec celui qui est alimenté par Mysql et 5 classificateurs d'apprentissage automatique populaires. Le modèle basé sur Milvus surpasse ses homologues en termes de précision.</p>
<pre><code translate="no"><span class="hljs-keyword">from</span> sklearn.<span class="hljs-property">model_selection</span> <span class="hljs-keyword">import</span> train_test_split
X, y = human_sequence_kmers, human_labels
X_train, X_test, y_train, y_test = <span class="hljs-title function_">train_test_split</span>(X, y, test_size=<span class="hljs-number">0.2</span>, random_state=<span class="hljs-number">42</span>)
<button class="copy-code-btn"></button></code></pre>
<p>
  
   <span class="img-wrapper"> <img translate="no" src="https://assets.zilliz.com/1_6541a7dec6.png" alt="1.png" class="doc-image" id="1.png" />
   </span> <span class="img-wrapper"> <span>1.png</span> </span></p>
<custom-h1>Exploration plus poussée</custom-h1><p>Avec le développement de la technologie du big data, la vectorisation des séquences d'ADN jouera un rôle plus important dans la recherche et la pratique génétiques. Combinées aux connaissances professionnelles en bioinformatique, les études connexes peuvent bénéficier davantage de l'implication de la vectorisation des séquences d'ADN. Milvus peut donc présenter de meilleurs résultats dans la pratique. En fonction des différents scénarios et des besoins des utilisateurs, la recherche de similarité et le calcul de distance alimentés par Milvus présentent un grand potentiel et de nombreuses possibilités.</p>
<ul>
<li><strong>Étudier des séquences inconnues</strong>: <a href="https://iopscience.iop.org/article/10.1088/1742-6596/1453/1/012071/pdf">Selon certains chercheurs, la vectorisation permet de compresser les données relatives aux séquences d'ADN.</a> En même temps, l'étude de la structure, de la fonction et de l'évolution de séquences d'ADN inconnues demande moins d'efforts. Milvus peut stocker et récupérer un très grand nombre de vecteurs de séquences d'ADN sans perdre en précision.</li>
<li><strong>Adapter les appareils</strong>: Limitée par les algorithmes traditionnels d'alignement de séquences, la recherche de similarités peut à peine bénéficier de l'amélioration des appareils<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7884812/">(</a><a href="https://mjeer.journals.ekb.eg/article_146090.html">CPU/GPU</a>). Milvus, qui prend en charge à la fois le calcul CPU normal et l'accélération GPU, résout ce problème grâce à l'algorithme approximatif du plus proche voisin.</li>
<li><strong>Détecter les virus et retracer leurs origines</strong>: <a href="https://www.nature.com/articles/s41586-020-2012-7?fbclid=IwAR2hxnXb9nLWgA8xexEoNrCNH8WHqvHhhbN38aSm48AaH6fTzGMB1BLljf4">Les scientifiques ont comparé les séquences génomiques et rapporté que le virus COVID19, probablement d'origine chauve-souris, appartient au SARS-COV</a>. Sur la base de cette conclusion, les chercheurs peuvent augmenter la taille de l'échantillon pour obtenir davantage de preuves et de modèles.</li>
<li><strong>Diagnostiquer des maladies</strong>: D'un point de vue clinique, les médecins pourraient comparer les séquences d'ADN entre les patients et les groupes sains afin d'identifier les gènes variants à l'origine des maladies. Il est possible d'extraire des caractéristiques et d'encoder ces données à l'aide d'algorithmes appropriés. Milvus est capable de renvoyer les distances entre les vecteurs, qui peuvent être liées aux données relatives aux maladies. Outre l'aide au diagnostic des maladies, cette application peut également inspirer l'étude des <a href="https://www.frontiersin.org/articles/10.3389/fgene.2021.680117/full">thérapies ciblées</a>.</li>
</ul>
<custom-h1>En savoir plus sur Milvus</custom-h1><p>Milvus est un outil puissant capable d'alimenter une vaste gamme d'applications d'intelligence artificielle et de recherche de similarités vectorielles. Pour en savoir plus sur le projet, consultez les ressources suivantes :</p>
<ul>
<li>Lisez notre <a href="https://milvus.io/blog">blog</a>.</li>
<li>Interagissez avec notre communauté open-source sur <a href="https://milvusio.slack.com/join/shared_invite/zt-e0u4qu3k-bI2GDNys3ZqX1YCJ9OM~GQ#/shared-invite/email">Slack</a>.</li>
<li>Utilisez ou contribuez à la base de données vectorielles la plus populaire au monde sur <a href="https://github.com/milvus-io/milvus/">GitHub</a>.</li>
<li>Testez et déployez rapidement des applications d'IA grâce à notre nouveau <a href="https://github.com/milvus-io/bootcamp">bootcamp</a>.</li>
</ul>
