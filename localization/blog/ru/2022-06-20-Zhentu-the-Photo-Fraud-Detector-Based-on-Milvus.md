---
id: 2022-06-20-Zhentu-the-Photo-Fraud-Detector-Based-on-Milvus.md
title: Zhentu - детектор фотомошенничества на основе Milvus
author: 'Yan Shi, Minwei Tang'
date: 2022-06-20T00:00:00.000Z
desc: >-
  Как построена система обнаружения Zhentu с использованием Milvus в качестве
  системы поиска векторов?
cover: assets.zilliz.com/zhentu_0ae11c98ee.png
tag: Scenarios
tags: Use Cases of Milvus
canonicalUrl: >-
  https://milvus.io/blog/2022-06-20-Zhentu-the-Photo-Fraud-Detector-Based-on-Milvus.md
---
<p>
  
   <span class="img-wrapper"> <img translate="no" src="https://assets.zilliz.com/zhentu_0ae11c98ee.png" alt="cover image" class="doc-image" id="cover-image" />
   </span> <span class="img-wrapper"> <span>изображение обложки</span> </span></p>
<blockquote>
<p>Эта статья написана Янь Ши и Минвэй Тан, старшими инженерами-алгоритмистами компании BestPay, а переведена <a href="https://www.linkedin.cn/incareer/in/rosie-zhang-694528149">Рози Чжан</a>.</p>
</blockquote>
<p>В последние годы, когда электронная коммерция и онлайн-транзакции стали обычным делом во всем мире, расцвело и мошенничество в сфере электронной коммерции. Используя сгенерированные компьютером фотографии вместо реальных для прохождения проверки личности на платформах онлайн-бизнеса, мошенники создают массовые поддельные аккаунты и наживаются на специальных предложениях компаний (например, подарках, купонах, жетонах), что приносит невосполнимые убытки как потребителям, так и компаниям.</p>
<p>Традиционные методы контроля рисков перестают быть эффективными перед лицом огромного количества данных. Для решения этой проблемы компания <a href="https://www.bestpay.com.cn">BestPay</a> создала детектор фотомошенничества Zhentu (в переводе с китайского означает "обнаружение изображений"), основанный на технологиях глубокого обучения (DL) и цифровой обработки изображений (DIP). Zhentu может применяться в различных сценариях, связанных с распознаванием изображений, одним из важных ответвлений которых является выявление поддельных бизнес-лицензий. Если фотография бизнес-лицензии, предоставленная пользователем, очень похожа на другую фотографию, уже имеющуюся в фотобиблиотеке платформы, то, скорее всего, пользователь где-то украл фотографию или подделал лицензию в мошеннических целях.</p>
<p>Традиционные алгоритмы измерения сходства изображений, такие как <a href="https://en.wikipedia.org/wiki/Peak_signal-to-noise_ratio">PSNR</a> и ORB, медленны и неточны и применимы только для офлайн-задач. Глубокое обучение, с другой стороны, способно обрабатывать большие объемы данных об изображениях в режиме реального времени и является идеальным методом для сопоставления похожих изображений. Совместными усилиями команды разработчиков BestPay и <a href="https://milvus.io/">сообщества Milvus</a> в рамках Zhentu была разработана система обнаружения фотомошенничества. Она функционирует путем преобразования огромных объемов данных об изображениях в векторы признаков с помощью моделей глубокого обучения и введения их в <a href="https://milvus.io/">Milvus</a>, векторную поисковую систему. С помощью Milvus система обнаружения способна индексировать триллионы векторов и эффективно находить похожие фотографии среди десятков миллионов изображений.</p>
<p><strong>Перейти к:</strong></p>
<ul>
<li><a href="#an-overview-of-zhentu">Обзор Zhentu</a></li>
<li><a href="#system-structure">Структура системы</a></li>
<li><a href="#deployment"><strong>Развертывание</strong></a></li>
<li><a href="#real-world-performance"><strong>Производительность в реальном мире</strong></a></li>
<li><a href="#reference"><strong>Ссылка</strong></a></li>
<li><a href="#about-bestpay"><strong>О BestPay</strong></a></li>
</ul>
<h2 id="An-overview-of-Zhentu" class="common-anchor-header">Обзор Zhentu<button data-href="#An-overview-of-Zhentu" class="anchor-icon" translate="no">
      <svg translate="no"
        aria-hidden="true"
        focusable="false"
        height="20"
        version="1.1"
        viewBox="0 0 16 16"
        width="16"
      >
        <path
          fill="#0092E4"
          fill-rule="evenodd"
          d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"
        ></path>
      </svg>
    </button></h2><p>Zhentu - это разработанный BestPay мультимедийный продукт визуального контроля рисков, глубоко интегрированный с технологиями машинного обучения (ML) и нейросетевого распознавания изображений. Его встроенный алгоритм может точно идентифицировать мошенников во время аутентификации пользователя и реагировать на уровне миллисекунды. Благодаря передовой технологии и инновационному решению Zhentu получила пять патентов и два авторских права на программное обеспечение. В настоящее время система используется во многих банках и финансовых учреждениях для заблаговременного выявления потенциальных рисков.</p>
<h2 id="System-structure" class="common-anchor-header">Структура системы<button data-href="#System-structure" class="anchor-icon" translate="no">
      <svg translate="no"
        aria-hidden="true"
        focusable="false"
        height="20"
        version="1.1"
        viewBox="0 0 16 16"
        width="16"
      >
        <path
          fill="#0092E4"
          fill-rule="evenodd"
          d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"
        ></path>
      </svg>
    </button></h2><p>В настоящее время в BestPay хранится более 10 миллионов фотографий бизнес-лицензий, и этот объем продолжает расти в геометрической прогрессии по мере развития бизнеса. Чтобы быстро находить похожие фотографии из такой большой базы данных, Zhentu выбрала Milvus в качестве механизма расчета сходства векторов признаков. Общая структура системы обнаружения фотомошенничества показана на схеме ниже.</p>
<p>
  
   <span class="img-wrapper"> <img translate="no" src="https://assets.zilliz.com/Structure_of_the_photo_fraud_detection_system_cf5d20d431.png" alt="img" class="doc-image" id="img" />
   </span> <span class="img-wrapper"> <span>img</span> </span></p>
<p>Процедуру можно разделить на четыре этапа:</p>
<ol>
<li><p>Предварительная обработка изображения. Предварительная обработка, включающая шумоподавление, удаление шумов и повышение контрастности, обеспечивает как сохранность исходной информации, так и удаление бесполезной информации из сигнала изображения.</p></li>
<li><p>Извлечение вектора признаков. Специально обученная модель глубокого обучения используется для извлечения векторов признаков изображения. Преобразование изображений в векторы для дальнейшего поиска сходства является рутинной операцией.</p></li>
<li><p>Нормализация. Нормализация извлеченных векторов признаков позволяет повысить эффективность последующей обработки.</p></li>
<li><p>Векторный поиск с помощью Milvus. Вставка нормализованных векторов признаков в базу данных Milvus для поиска векторного сходства.</p></li>
</ol>
<h2 id="Deployment" class="common-anchor-header"><strong>Развертывание</strong><button data-href="#Deployment" class="anchor-icon" translate="no">
      <svg translate="no"
        aria-hidden="true"
        focusable="false"
        height="20"
        version="1.1"
        viewBox="0 0 16 16"
        width="16"
      >
        <path
          fill="#0092E4"
          fill-rule="evenodd"
          d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"
        ></path>
      </svg>
    </button></h2><p>Ниже приведено краткое описание развертывания системы обнаружения фотомошенничества Zhentu.</p>
<p>
  
   <span class="img-wrapper"> <img translate="no" src="https://assets.zilliz.com/milvus_architecture_ea45a5ab53.png" alt="Milvus system architecture" class="doc-image" id="milvus-system-architecture" />
   </span> <span class="img-wrapper"> <span>Архитектура системы Milvus</span> </span></p>
<p>Мы развернули наш <a href="https://milvus.io/docs/v2.0.x/install_cluster-helm.md">кластер Milvus на Kubernetes</a>, чтобы обеспечить высокую доступность и синхронизацию облачных сервисов в режиме реального времени. Общие шаги следующие:</p>
<ol>
<li><p>Просмотр доступных ресурсов. Выполните команду <code translate="no">kubectl describe nodes</code>, чтобы увидеть ресурсы, которые кластер Kubernetes может выделить для созданных кейсов.</p></li>
<li><p>Выделить ресурсы. Выполните команду <code translate="no">kubect`` -- apply xxx.yaml</code>, чтобы выделить ресурсы памяти и процессора для компонентов кластера Milvus с помощью Helm.</p></li>
<li><p>Примените новую конфигурацию. Выполните команду <code translate="no">helm upgrade my-release milvus/milvus --reuse-values -fresources.yaml</code>.</p></li>
<li><p>Примените новую конфигурацию к кластеру Milvus. Развернутый таким образом кластер не только позволяет нам регулировать мощность системы в соответствии с различными потребностями бизнеса, но и лучше отвечает требованиям к высокой производительности при массовом поиске векторных данных.</p></li>
</ol>
<p>Вы можете <a href="https://milvus.io/docs/v2.0.x/configure-docker.md">настроить Milvus</a> на оптимизацию производительности поиска для различных типов данных из разных бизнес-сценариев, как показано в следующих двух примерах.</p>
<p>При <a href="https://milvus.io/docs/v2.0.x/build_index.md">построении векторного индекса</a> мы параметризуем его в соответствии с реальным сценарием работы системы следующим образом:</p>
<pre><code translate="no" class="language-Python">index = {<span class="hljs-string">&quot;index_type&quot;</span>: <span class="hljs-string">&quot;IVF_PQ&quot;</span>, <span class="hljs-string">&quot;params&quot;</span>: {<span class="hljs-string">&quot;nlist&quot;</span>: <span class="hljs-number">2048</span>}, <span class="hljs-string">&quot;metric_type&quot;</span>: <span class="hljs-string">&quot;IP&quot;</span>}
<button class="copy-code-btn"></button></code></pre>
<p><a href="https://milvus.io/docs/v2.0.x/index.md#IVF_PQ">IVF_PQ</a> выполняет кластеризацию индекса IVF перед квантованием произведения векторов. Он отличается высокой скоростью запроса к диску и очень низким потреблением памяти, что соответствует потребностям реального применения Zhentu.</p>
<p>Кроме того, мы установили оптимальные параметры поиска следующим образом:</p>
<pre><code translate="no" class="language-Python">search_params = {<span class="hljs-string">&quot;metric_type&quot;</span>: <span class="hljs-string">&quot;IP&quot;</span>, <span class="hljs-string">&quot;params&quot;</span>: {<span class="hljs-string">&quot;nprobe&quot;</span>: <span class="hljs-number">32</span>}}
<button class="copy-code-btn"></button></code></pre>
<p>Поскольку векторы уже нормализованы перед вводом в Milvus, для вычисления расстояния между двумя векторами выбирается внутреннее произведение (IP). Эксперименты показали, что при использовании IP коэффициент запоминания увеличивается примерно на 15 % по сравнению с евклидовым расстоянием (L2).</p>
<p>Приведенные выше примеры показывают, что мы можем тестировать и настраивать параметры Milvus в соответствии с различными бизнес-сценариями и требованиями к производительности.</p>
<p>Кроме того, Milvus не только интегрирует различные библиотеки индексов, но и поддерживает различные типы индексов и методы расчета сходства. Milvus также предоставляет официальные SDK на нескольких языках и богатые API для вставки, запроса и т. д., что позволяет нашим внешним бизнес-группам использовать SDK для обращения к центру контроля рисков.</p>
<h2 id="Real-world-performance" class="common-anchor-header"><strong>Работа в реальных условиях</strong><button data-href="#Real-world-performance" class="anchor-icon" translate="no">
      <svg translate="no"
        aria-hidden="true"
        focusable="false"
        height="20"
        version="1.1"
        viewBox="0 0 16 16"
        width="16"
      >
        <path
          fill="#0092E4"
          fill-rule="evenodd"
          d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"
        ></path>
      </svg>
    </button></h2><p>На данный момент система обнаружения фотомошенничества работает стабильно, помогая компаниям выявлять потенциальных мошенников. В 2021 году она обнаружила более 20 000 поддельных лицензий в течение года. Что касается скорости запросов, то запрос одного вектора среди десятков миллионов векторов занимает менее 1 секунды, а среднее время пакетного запроса составляет менее 0,08 секунды. Высокопроизводительный поиск Milvus удовлетворяет потребности компаний в точности и параллельности.</p>
<h2 id="Reference" class="common-anchor-header"><strong>Ссылка</strong><button data-href="#Reference" class="anchor-icon" translate="no">
      <svg translate="no"
        aria-hidden="true"
        focusable="false"
        height="20"
        version="1.1"
        viewBox="0 0 16 16"
        width="16"
      >
        <path
          fill="#0092E4"
          fill-rule="evenodd"
          d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"
        ></path>
      </svg>
    </button></h2><p>Aglave P, Kolkure V S. Реализация высокопроизводительного метода извлечения признаков с использованием ориентированного быстрого и вращающегося алгоритма Brief[J]. Int. J. Res. Eng. Technol, 2015, 4: 394-397.</p>
<h2 id="About-BestPay" class="common-anchor-header"><strong>О компании BestPay</strong><button data-href="#About-BestPay" class="anchor-icon" translate="no">
      <svg translate="no"
        aria-hidden="true"
        focusable="false"
        height="20"
        version="1.1"
        viewBox="0 0 16 16"
        width="16"
      >
        <path
          fill="#0092E4"
          fill-rule="evenodd"
          d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"
        ></path>
      </svg>
    </button></h2><p>China Telecom BestPay Co., Ltd является дочерней компанией China Telecom, находящейся в полной собственности. Она занимается платежным и финансовым бизнесом. BestPay стремится использовать передовые технологии, такие как большие данные, искусственный интеллект и облачные вычисления, для внедрения инноваций в бизнес, предоставляя интеллектуальные продукты, решения для контроля рисков и другие услуги. По состоянию на январь 2016 года приложение BestPay привлекло более 200 миллионов пользователей и стало третьим по величине оператором платежных платформ в Китае, следуя за Alipay и WeChat Payment.</p>
