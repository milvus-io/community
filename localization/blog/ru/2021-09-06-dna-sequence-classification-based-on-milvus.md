---
id: dna-sequence-classification-based-on-milvus.md
title: Классификация последовательностей ДНК на основе Milvus
author: Jael Gu
date: 2021-09-06T06:02:27.431Z
desc: >-
  Используйте Milvus, базу данных векторов с открытым исходным кодом, для
  распознавания семейств генов в последовательностях ДНК. Меньше места, но выше
  точность.
cover: assets.zilliz.com/11111_5d089adf08.png
tag: Scenarios
canonicalUrl: 'https://zilliz.com/blog/dna-sequence-classification-based-on-milvus'
---
<custom-h1>Классификация последовательностей ДНК на основе Milvus</custom-h1><blockquote>
<p>Автор: Менгджиа Гу, инженер по данным в Zilliz, окончила Университет Макгилла со степенью магистра в области информационных исследований. В сферу ее интересов входят приложения ИИ и поиск сходства в векторных базах данных. В качестве члена сообщества открытого проекта Milvus она предоставляла и улучшала различные решения, такие как рекомендательная система и модель классификации последовательностей ДНК. Ей нравятся сложные задачи, и она никогда не сдается!</p>
</blockquote>
<custom-h1>Введение</custom-h1><p>Последовательность ДНК - популярное понятие как в академических исследованиях, так и в практических приложениях, таких как отслеживание генов, идентификация видов и диагностика заболеваний. В то время как все отрасли изголодались по более интеллектуальным и эффективным методам исследования, искусственный интеллект привлек большое внимание, особенно в биологической и медицинской области. Все больше ученых и исследователей вносят свой вклад в машинное обучение и глубокое обучение в биоинформатике. Чтобы сделать экспериментальные результаты более убедительными, одним из распространенных вариантов является увеличение размера выборки. Взаимодействие с большими данными в геномике также дает больше возможностей для использования в реальности. Однако традиционное выравнивание последовательностей имеет ограничения, которые делают его <a href="https://www.frontiersin.org/articles/10.3389/fbioe.2020.01032/full#h5">непригодным для больших данных</a>. Для того чтобы сделать меньший компромисс в реальности, векторизация является хорошим выбором для больших наборов данных последовательностей ДНК.</p>
<p>Векторная база данных <a href="https://milvus.io/docs/v2.0.x/overview.md">Milvus</a> с открытым исходным кодом подходит для массивных данных. Она способна хранить векторы последовательностей нуклеиновых кислот и выполнять высокоэффективный поиск. Она также может помочь снизить стоимость производства или исследований. Система классификации последовательностей ДНК, основанная на Milvus, выполняет классификацию генов всего за миллисекунды. Кроме того, она показывает более высокую точность, чем другие распространенные классификаторы машинного обучения.</p>
<custom-h1>Обработка данных</custom-h1><p>Ген, кодирующий генетическую информацию, состоит из небольшого участка последовательности ДНК, состоящей из 4 нуклеотидных оснований [A, C, G, T]. В геноме человека насчитывается около 30 000 генов, почти 3 миллиарда пар оснований ДНК, и каждая пара оснований имеет 2 соответствующих основания. Чтобы обеспечить разнообразное использование, последовательности ДНК можно разделить на различные категории. Чтобы снизить стоимость и упростить использование данных о длинных последовательностях ДНК, в предварительную обработку данных вводится <a href="https://en.wikipedia.org/wiki/K-mer#:~:text=Usually%2C%20the%20term%20k%2Dmer,total%20possible%20k%2Dmers%2C%20where">к-мер </a>. При этом данные последовательности ДНК становятся более похожими на обычный текст. Кроме того, векторизованные данные могут ускорить вычисления при анализе данных или машинном обучении.</p>
<p>
  
   <span class="img-wrapper"> <img translate="no" src="https://assets.zilliz.com/1_a7469e9eac.png" alt="1.png" class="doc-image" id="1.png" />
   </span> <span class="img-wrapper"> <span>1.png</span> </span></p>
<p><strong>k-mer</strong></p>
<p>Метод k-mer широко используется при предварительной обработке последовательностей ДНК. Он выделяет небольшой участок длины k, начиная с каждого основания исходной последовательности, тем самым преобразуя длинную последовательность длины s в (s-k+1) коротких последовательностей длины k. Регулировка значения k улучшает работу модели. Списки коротких последовательностей удобнее для чтения данных, извлечения признаков и векторизации.</p>
<p><strong>Векторизация</strong></p>
<p>Последовательности ДНК векторизуются в виде текста. Последовательность, преобразованная с помощью k-mer, превращается в список коротких последовательностей, который выглядит как список отдельных слов в предложении. Поэтому большинство моделей обработки естественного языка должны работать и для данных о последовательностях ДНК. Аналогичные методики можно применить к обучению моделей, извлечению признаков и кодированию. Поскольку у каждой модели есть свои преимущества и недостатки, выбор моделей зависит от особенностей данных и цели исследования. Например, CountVectorizer, модель мешка слов, реализует извлечение признаков через простую токенизацию. Она не устанавливает ограничений на длину данных, но получаемый результат менее очевиден с точки зрения сравнения сходства.</p>
<custom-h1>Демонстрация Milvus</custom-h1><p>Milvus может легко управлять неструктурированными данными и находить наиболее похожие результаты среди триллионов векторов за среднюю задержку в миллисекунды. Поиск сходства основан на алгоритме приближенного поиска ближайших соседей (ANN). Эти особенности делают Milvus отличным вариантом для управления векторами последовательностей ДНК, а значит, способствуют развитию и применению биоинформатики.</p>
<p>Ниже представлен демонстрационный пример построения системы классификации последовательностей ДНК с помощью Milvus. <a href="https://www.kaggle.com/nageshsingh/dna-sequence-dataset">Экспериментальный набор данных </a>включает 3 организма и 7 семейств генов. Все данные преобразуются в списки коротких последовательностей по k-мерам. С помощью предварительно обученной модели CountVectorizer система кодирует данные о последовательностях в векторы. На блок-схеме ниже показана структура системы и процессы вставки и поиска.</p>
<p>
  
   <span class="img-wrapper"> <img translate="no" src="https://assets.zilliz.com/1_ebd89660f6.png" alt="1.png" class="doc-image" id="1.png" />
   </span> <span class="img-wrapper"> <span>1.png</span> </span></p>
<p>Попробуйте эту демонстрацию в <a href="https://github.com/milvus-io/bootcamp/tree/master/solutions/dna_sequence_classification">Milvus bootcamp</a>.</p>
<p>В Milvus система создает коллекцию и вставляет соответствующие векторы последовательностей ДНК в коллекцию (или раздел, если он включен). При получении запроса Milvus возвращает расстояния между вектором входной последовательности ДНК и наиболее похожими результатами в базе данных. По расстояниям между векторами в результатах можно определить класс входной последовательности и сходство между последовательностями ДНК.</p>
<pre><code translate="no"><span class="hljs-comment"># Insert vectors to Milvus collection (partition &quot;human&quot;)</span>
DNA_human = collection.insert([human_ids, human_vectors], partition_name=<span class="hljs-string">&#x27;human&#x27;</span>)
<span class="hljs-comment"># Search topK results (in partition &quot;human&quot;) for test vectors</span>
res = collection.search(test_vectors, <span class="hljs-string">&quot;vector_field&quot;</span>, search_params, limit=topK, partition_names=[<span class="hljs-string">&#x27;human&#x27;</span>])
<span class="hljs-keyword">for</span> results <span class="hljs-keyword">in</span> res:
    res_ids = results.ids <span class="hljs-comment"># primary keys of topK results</span>
    res_distances = results.distances <span class="hljs-comment"># distances between topK results &amp; search input</span>
<button class="copy-code-btn"></button></code></pre>
<p><strong>Классификация последовательностей ДНК</strong>Поиск наиболее похожих последовательностей ДНК в Milvus позволяет определить семейство генов неизвестного образца и, таким образом, узнать о его возможной функциональности.<a href="https://www.nature.com/scitable/topicpage/gpcr-14047471/"> Если последовательность классифицируется как GPCRs, то, вероятно, она влияет на функции организма. </a>В этой демонстрации Milvus успешно позволил системе идентифицировать семейства генов искомых последовательностей человеческой ДНК.</p>
<p>
  
   <span class="img-wrapper"> <img translate="no" src="https://assets.zilliz.com/3_1616da5bb0.png" alt="3.png" class="doc-image" id="3.png" />
   </span> <span class="img-wrapper"> <span>3.png</span> </span> <span class="img-wrapper"> <img translate="no" src="https://assets.zilliz.com/4_d719b22fc7.png" alt="4.png" class="doc-image" id="4.png" /><span>4.png</span> </span></p>
<p><strong>Генетическое сходство</strong></p>
<p>Среднее сходство последовательностей ДНК между организмами показывает, насколько близки их геномы. Демонстрация ищет в человеческих данных наиболее похожие последовательности ДНК шимпанзе и собаки соответственно. Затем вычисляется и сравнивается среднее внутреннее произведение расстояний (0,97 для шимпанзе и 0,70 для собаки), что доказывает, что шимпанзе имеет больше схожих генов с человеком, чем собака. С учетом более сложных данных и дизайна системы Milvus способен поддерживать генетические исследования даже на более высоком уровне.</p>
<pre><code translate="no">search_params = {<span class="hljs-string">&quot;metric_type&quot;</span>: <span class="hljs-string">&quot;IP&quot;</span>, <span class="hljs-string">&quot;params&quot;</span>: {<span class="hljs-string">&quot;nprobe&quot;</span>: <span class="hljs-number">20</span>}}
<button class="copy-code-btn"></button></code></pre>
<p><strong>Производительность</strong></p>
<p>Демонстрация обучает модель классификации на 80 % данных о человеке (всего 3629) и использует оставшиеся данные в качестве тестовых. Сравнивается производительность модели классификации последовательностей ДНК, использующей Milvus, с моделью на базе Mysql и 5 популярных классификаторов машинного обучения. Модель на основе Milvus превосходит свои аналоги по точности.</p>
<pre><code translate="no"><span class="hljs-keyword">from</span> sklearn.<span class="hljs-property">model_selection</span> <span class="hljs-keyword">import</span> train_test_split
X, y = human_sequence_kmers, human_labels
X_train, X_test, y_train, y_test = <span class="hljs-title function_">train_test_split</span>(X, y, test_size=<span class="hljs-number">0.2</span>, random_state=<span class="hljs-number">42</span>)
<button class="copy-code-btn"></button></code></pre>
<p>
  
   <span class="img-wrapper"> <img translate="no" src="https://assets.zilliz.com/1_6541a7dec6.png" alt="1.png" class="doc-image" id="1.png" />
   </span> <span class="img-wrapper"> <span>1.png</span> </span></p>
<custom-h1>Дальнейшее исследование</custom-h1><p>С развитием технологий больших данных векторизация последовательности ДНК будет играть все более важную роль в генетических исследованиях и практике. В сочетании с профессиональными знаниями в области биоинформатики, соответствующие исследования могут получить дополнительную выгоду от участия в векторизации последовательности ДНК. Таким образом, Milvus может дать лучшие результаты на практике. В соответствии с различными сценариями и потребностями пользователей, поиск сходства и расчет расстояния с помощью Milvus демонстрируют большой потенциал и множество возможностей.</p>
<ul>
<li><strong>Изучение неизвестных последовательностей</strong>: <a href="https://iopscience.iop.org/article/10.1088/1742-6596/1453/1/012071/pdf">По мнению некоторых исследователей, векторизация позволяет сжимать данные о последовательностях ДНК.</a> В то же время она требует меньше усилий для изучения структуры, функции и эволюции неизвестных последовательностей ДНК. Milvus может хранить и извлекать огромное количество векторов последовательностей ДНК без потери точности.</li>
<li><strong>Адаптируемые устройства</strong>: Ограниченный традиционными алгоритмами выравнивания последовательностей, поиск по сходству едва ли может выиграть от совершенствования устройств<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7884812/">(</a><a href="https://mjeer.journals.ekb.eg/article_146090.html">CPU/GPU</a>). Milvus, поддерживающий как обычные вычисления на CPU, так и ускорение на GPU, решает эту проблему с помощью алгоритма приближенного ближайшего соседа.</li>
<li><strong>Обнаружение вирусов и отслеживание их происхождения</strong>: <a href="https://www.nature.com/articles/s41586-020-2012-7?fbclid=IwAR2hxnXb9nLWgA8xexEoNrCNH8WHqvHhhbN38aSm48AaH6fTzGMB1BLljf4">Ученые сравнили геномные последовательности и сообщили, что вирус COVID19 вероятного происхождения от летучей мыши принадлежит к SARS-COV</a>. Основываясь на этом заключении, исследователи могут увеличить размер выборки для получения дополнительных доказательств и закономерностей.</li>
<li><strong>Диагностика заболеваний</strong>: В клинических условиях врачи могут сравнивать последовательности ДНК пациентов и здоровых людей, чтобы выявить варианты генов, вызывающих заболевания. Можно извлечь особенности и закодировать эти данные с помощью соответствующих алгоритмов. Milvus способен возвращать расстояния между векторами, которые могут быть связаны с данными о заболеваниях. Помимо помощи в диагностике заболеваний, это приложение также может вдохновить на изучение <a href="https://www.frontiersin.org/articles/10.3389/fgene.2021.680117/full">целевой терапии</a>.</li>
</ul>
<custom-h1>Узнайте больше о Milvus</custom-h1><p>Milvus - это мощный инструмент, способный обеспечить работу огромного количества приложений для искусственного интеллекта и поиска векторного сходства. Чтобы узнать больше о проекте, ознакомьтесь со следующими ресурсами:</p>
<ul>
<li>Читайте наш <a href="https://milvus.io/blog">блог</a>.</li>
<li>Общайтесь с нашим сообществом разработчиков открытого кода в <a href="https://milvusio.slack.com/join/shared_invite/zt-e0u4qu3k-bI2GDNys3ZqX1YCJ9OM~GQ#/shared-invite/email">Slack</a>.</li>
<li>Используйте самую популярную в мире базу данных векторов на <a href="https://github.com/milvus-io/milvus/">GitHub</a> и вносите в нее свой вклад.</li>
<li>Быстро протестируйте и разверните приложения ИИ с помощью нашего нового <a href="https://github.com/milvus-io/bootcamp">буткемпа</a>.</li>
</ul>
