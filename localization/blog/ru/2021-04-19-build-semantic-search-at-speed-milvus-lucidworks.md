---
id: build-semantic-search-at-speed-milvus-lucidworks.md
title: Создайте семантический поиск на высокой скорости
author: Elizabeth Edmiston
date: 2021-04-19T07:32:50.416Z
desc: >-
  Узнайте больше об использовании методологии семантического машинного обучения
  для повышения релевантности результатов поиска в вашей организации.
cover: assets.zilliz.com/lucidworks_4753c98727.png
tag: Scenarios
canonicalUrl: 'https://zilliz.com/blog/build-semantic-search-at-speed-milvus-lucidworks'
---
<custom-h1>Создайте семантический поиск на высокой скорости</custom-h1><p><a href="https://lucidworks.com/post/what-is-semantic-search/">Семантический поиск</a> - отличный инструмент, помогающий вашим клиентам или сотрудникам находить нужные продукты или информацию. Он может даже выводить на поверхность трудноиндексируемую информацию для достижения лучших результатов. Однако если ваши семантические методологии не развернуты для быстрой работы, они не принесут вам никакой пользы. Клиент или сотрудник не собирается сидеть сложа руки, пока система не спешит отвечать на его запрос, а ведь одновременно с ним может быть получена еще тысяча других.</p>
<p>Как сделать семантический поиск быстрым? Медленный семантический поиск не подходит.</p>
<p>К счастью, Lucidworks любит решать именно такие проблемы. Недавно мы протестировали кластер скромных размеров - читайте дальше, чтобы узнать подробности - и получили 1500 RPS (запросов в секунду) для коллекции из более чем миллиона документов со средним временем ответа около 40 миллисекунд. Вот это уже серьезная скорость.</p>
<p><br/></p>
<h3 id="Implementing-Semantic-Search" class="common-anchor-header">Реализация семантического поиска</h3><p>Чтобы сделать магию машинного обучения молниеносной, Lucidworks реализовала семантический поиск, используя подход семантического векторного поиска. Здесь есть две важные части.</p>
<p><br/></p>
<h4 id="Part-One-The-Machine-Learning-Model" class="common-anchor-header">Часть первая: модель машинного обучения</h4><p>Во-первых, вам нужен способ закодировать текст в числовой вектор. Этим текстом может быть описание продукта, поисковый запрос пользователя, вопрос или даже ответ на вопрос. Модель семантического поиска обучается кодировать текст таким образом, чтобы текст, семантически схожий с другими текстами, кодировался в векторы, которые численно "близки" друг к другу. Этот этап кодирования должен быть быстрым, чтобы поддерживать тысячу или более возможных запросов клиентов или пользователей, поступающих каждую секунду.</p>
<p><br/></p>
<h4 id="Part-Two-The-Vector-Search-Engine" class="common-anchor-header">Часть вторая: Векторная поисковая система</h4><p>Во-вторых, вам нужен способ быстро найти наилучшие совпадения с запросом клиента или пользователя. В модели текст будет закодирован в числовой вектор. Затем вам нужно сравнить его со всеми числовыми векторами в вашем каталоге или списках вопросов и ответов, чтобы найти эти лучшие соответствия - векторы, которые "ближе всего" к вектору запроса. Для этого вам понадобится векторный движок, способный эффективно и молниеносно обрабатывать всю эту информацию. Он может содержать миллионы векторов, а вам нужны только двадцать или около того лучших совпадений с вашим запросом. И, конечно, он должен обрабатывать тысячу или около того таких запросов каждую секунду.</p>
<p>Чтобы решить эти проблемы, мы добавили векторный поисковый движок <a href="https://doc.lucidworks.com/fusion/5.3/8821/milvus">Milvus</a> в наш <a href="https://lucidworks.com/post/enhance-personalization-efforts-with-new-features-in-fusion/">выпуск Fusion 5.3</a>. Milvus - это программное обеспечение с открытым исходным кодом, и он очень быстрый. Milvus использует FAISS<a href="https://ai.facebook.com/tools/faiss/">(Facebook AI Similarity Search</a>), ту же самую технологию, которую Facebook использует в производстве для своих собственных инициатив в области машинного обучения. При необходимости он может работать еще быстрее на <a href="https://en.wikipedia.org/wiki/Graphics_processing_unit">GPU</a>. При установке Fusion 5.3 (или выше) с компонентом машинного обучения Milvus автоматически устанавливается как часть этого компонента, поэтому вы можете легко включить все эти возможности.</p>
<p>Размер векторов в данной коллекции, задаваемый при ее создании, зависит от модели, которая создает эти векторы. Например, в данной коллекции могут храниться векторы, созданные в результате кодирования (с помощью модели) всех описаний товаров в каталоге товаров. Без векторного поискового механизма, подобного Milvus, поиск по сходству во всем векторном пространстве был бы невозможен. Поэтому поиск по сходству пришлось бы ограничить заранее отобранными кандидатами из векторного пространства (например, 500), что привело бы к снижению производительности и качества результатов. Milvus может хранить сотни миллиардов векторов в нескольких коллекциях векторов, чтобы обеспечить быстроту поиска и релевантность результатов.</p>
<p><br/></p>
<h3 id="Using-Semantic-Search" class="common-anchor-header">Использование семантического поиска</h3><p>Давайте вернемся к рабочему процессу семантического поиска, после того как мы немного узнали о том, почему Milvus может быть так важен. Семантический поиск состоит из трех этапов. На первом этапе загружается и/или обучается модель машинного обучения. После этого данные индексируются в Milvus и Solr. Последний этап - это этап запроса, когда происходит собственно поиск. Ниже мы сосредоточимся на этих двух последних этапах.</p>
<p><br/></p>
<h3 id="Indexing-into-Milvus" class="common-anchor-header">Индексирование в Milvus</h3><p>
  
   <span class="img-wrapper"> <img translate="no" src="https://assets.zilliz.com/Lucidworks_1_47a9221723.png" alt="Lucidworks-1.png" class="doc-image" id="lucidworks-1.png" />
   </span> <span class="img-wrapper"> <span>Lucidworks-1.png</span> </span></p>
<p>Как показано на диаграмме выше, этап запросов начинается так же, как и этап индексирования, только вместо документов приходят запросы. Для каждого запроса:</p>
<ol>
<li>Запрос отправляется на конвейер индексации <a href="https://lucidworks.com/products/smart-answers/">Smart Answers</a>.</li>
<li>Затем запрос отправляется в модель ML.</li>
<li>ML-модель возвращает числовой вектор (зашифрованный из запроса). Опять же, тип модели определяет размер вектора.</li>
<li>Вектор отправляется в Milvus, который определяет, какие векторы в указанной коллекции Milvus лучше всего соответствуют предоставленному вектору.</li>
<li>Milvus возвращает список уникальных идентификаторов и расстояний, соответствующих векторам, определенным на четвертом шаге.</li>
<li>Запрос, содержащий эти идентификаторы и расстояния, отправляется в Solr.</li>
<li>Затем Solr возвращает упорядоченный список документов, связанных с этими идентификаторами.</li>
</ol>
<p><br/></p>
<h3 id="Scale-Testing" class="common-anchor-header">Тестирование масштаба</h3><p>Чтобы доказать, что наши потоки семантического поиска работают с той эффективностью, которая требуется нашим клиентам, мы провели масштабные тесты с помощью скриптов Gatling на облачной платформе Google Cloud Platform, используя кластер Fusion с восемью репликами ML-модели, восемью репликами сервиса запросов и одним экземпляром Milvus. Тесты проводились с использованием индексов Milvus FLAT и HNSW. Индекс FLAT имеет 100 % отзыв, но менее эффективен - за исключением случаев, когда наборы данных малы. Индекс HNSW (Hierarchical Small World Graph) по-прежнему показывает высокое качество результатов и улучшает производительность на больших наборах данных.</p>
<p>Давайте рассмотрим некоторые цифры из недавнего примера:</p>
<p>
  
   <span class="img-wrapper"> <img translate="no" src="https://assets.zilliz.com/Lucidworks_2_3162113560.png" alt="Lucidworks-2.png" class="doc-image" id="lucidworks-2.png" />
   </span> <span class="img-wrapper"> <span>Lucidworks-2.png</span> </span></p>
<p>
  
   <span class="img-wrapper"> <img translate="no" src="https://assets.zilliz.com/Lucidworks_3_3dc17f0ed8.png" alt="Lucidworks-3.png" class="doc-image" id="lucidworks-3.png" />
   </span> <span class="img-wrapper"> <span>Lucidworks-3.png</span> </span></p>
<p>
  
   <span class="img-wrapper"> <img translate="no" src="https://assets.zilliz.com/Lucidworks_4_8a6edd2f59.png" alt="Lucidworks-4.png" class="doc-image" id="lucidworks-4.png" />
   </span> <span class="img-wrapper"> <span>Lucidworks-4.png</span> </span></p>
<p><br/></p>
<h3 id="Getting-Started" class="common-anchor-header">Начало работы</h3><p>Конвейеры <a href="https://lucidworks.com/products/smart-answers/">Smart Answers</a> разработаны так, чтобы ими было легко пользоваться. В Lucidworks есть <a href="https://doc.lucidworks.com/how-to/734/set-up-a-pre-trained-cold-start-model-for-smart-answers">предварительно обученные модели, которые легко внедряются</a> и обычно дают хорошие результаты, хотя обучение собственных моделей в тандеме с предварительно обученными моделями даст наилучшие результаты. Свяжитесь с нами сегодня, чтобы узнать, как вы можете внедрить эти инициативы в свои поисковые инструменты для получения более эффективных и приятных результатов.</p>
<blockquote>
<p>Этот блог перепощен с сайта: https://lucidworks.com/post/how-to-build-fast-semantic-search/?utm_campaign=Oktopost-Blog+Posts&amp;utm_medium=organic_social&amp;utm_source=linkedin</p>
</blockquote>
